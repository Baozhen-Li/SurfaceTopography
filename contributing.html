
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contributing to SurfaceTopography &#8212; SurfaceTopography 1.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SurfaceTopography package" href="source/SurfaceTopography.html" />
    <link rel="prev" title="Testing" href="testing.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="source/SurfaceTopography.html" title="SurfaceTopography package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="testing.html" title="Testing"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SurfaceTopography 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Contributing to SurfaceTopography</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="contributing-to-surfacetopography">
<span id="contributing"></span><h1>Contributing to SurfaceTopography<a class="headerlink" href="#contributing-to-surfacetopography" title="Permalink to this headline">¶</a></h1>
<div class="section" id="code-style">
<h2>Code style<a class="headerlink" href="#code-style" title="Permalink to this headline">¶</a></h2>
<p>Always follow <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP-8</a>.
Documentation strings must follow the
<a class="reference external" href="https://numpydoc.readthedocs.io/">numpydoc</a> standard.</p>
<p>All parameters (for functions or methods) should be descriptive. Do not name
a parameter after a symbol (e.g. <cite>lambda</cite>) but rather say that it is
(e.g. <cite>large_wavelength_cutoff</cite>).</p>
</div>
<div class="section" id="development-branches">
<h2>Development branches<a class="headerlink" href="#development-branches" title="Permalink to this headline">¶</a></h2>
<p>New features should be developed always in its own branch. When creating your own branch,
please suffix that branch by the year of creation on a description of what is contains.
For example, if you are working on an implementation for line scans and you started that
work in 2018, the branch could be called “18_line_scans”.</p>
</div>
<div class="section" id="commits">
<h2>Commits<a class="headerlink" href="#commits" title="Permalink to this headline">¶</a></h2>
<p>Prepend you commits with a shortcut indicating the type of changes they contain:</p>
<ul class="simple">
<li><p>ENH: Enhancement (e.g. a new feature)</p></li>
<li><p>MAINT: Maintenance (e.g. fixing a typo)</p></li>
<li><p>DOC: Changes to documentation strings</p></li>
<li><p>BUG: Bug fix</p></li>
<li><p>TST: Changes to the unit test environment</p></li>
<li><p>CI: Changes to the CI configuration</p></li>
</ul>
<p>The changelog will be based on the content of the commits with tag BUG, API and ENH.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>If your are working on a new feature, use ENH on the commit making the feature ready. Before use the WIP tag.</p></li>
<li><p>use TST when your changes only deal with the testing environment. If you fix a bug and implement the test for it, use BUG.</p></li>
<li><p>minor changes that doesn’t change the codes behaviour (for example rewrite file in a cleaner or slightly efficienter way) belong to the tag MAINT</p></li>
<li><p>if you change documentation files without changing the code, use DOC; if you also change code in the same commit, use another shortcut</p></li>
</ul>
</div>
<div class="section" id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<p>Add yourself to the AUTHORS file using the email address that you are using for your
commits. We use this information to automatically generate copyright statements for
all files from the commit log.</p>
</div>
<div class="section" id="writing-tests">
<h2>Writing tests<a class="headerlink" href="#writing-tests" title="Permalink to this headline">¶</a></h2>
<p>Older tests are written using the <cite>unittest</cite> syntax. We now use <cite>pytest</cite> (that
understands almost all unittest syntax), because it is compatible with the
parallel test runner <a class="reference external" href="https://github.com/AntoineSIMTEK/runtests">runtests</a>.</p>
<p>If a whole test file should only be run in serial
and/or is incompatible with <cite>runtests</cite> (<cite>unittest</cite>), include following line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pytestmark</span> <span class="o">=</span> <span class="n">pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">skipif</span><span class="p">(</span><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">Get_size</span><span class="p">()</span><span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;tests only serial funcionalities, please execute with pytest&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The file will executed in a run with <cite>pytest</cite> and not with a (parallel) run with
<cite>python3 run-tests.py</cite></p>
<div class="section" id="mpi-tests">
<h3>MPI Tests<a class="headerlink" href="#mpi-tests" title="Permalink to this headline">¶</a></h3>
<p>In order to vary the number of processors used in the tests, you should always
explictely use the communicator defined as fixture in <cite>tests/conftest.py</cite> instead
of <cite>MPI.COMM_WORLD</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_parallel</span><span class="p">(</span><span class="n">comm</span><span class="p">):</span>
    <span class="n">substrate</span> <span class="o">=</span> <span class="n">PeriodicFFTElasticHalfSpace</span><span class="p">(</span><span class="o">....</span><span class="p">,</span> <span class="n">commincator</span><span class="o">=</span><span class="n">comm</span><span class="p">)</span>
    <span class="c1"># Take care not to let your functions use their default value</span>
    <span class="c1"># for the communicator !</span>
</pre></div>
</div>
<p>Note: a single test function that should be run only with one processor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_parallel</span><span class="p">(</span><span class="n">comm_serial</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="section" id="debug-plots-in-the-tests">
<h3>Debug plots in the tests<a class="headerlink" href="#debug-plots-in-the-tests" title="Permalink to this headline">¶</a></h3>
<p>Often when you develop your test you need to plot and print things to see what
happens. It is a good idea to let the plots ready for use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="bp">False</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="o">-</span> <span class="n">system</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">force</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="testing.html"
                        title="previous chapter">Testing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="source/SurfaceTopography.html"
                        title="next chapter">SurfaceTopography package</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="source/SurfaceTopography.html" title="SurfaceTopography package"
             >next</a> |</li>
        <li class="right" >
          <a href="testing.html" title="Testing"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SurfaceTopography 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Contributing to SurfaceTopography</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015-2020, Lars Pastewka.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>